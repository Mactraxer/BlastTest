window.__require=function e(t,o,i){function n(s,a){if(!o[s]){if(!t[s]){var l=s.split("/");if(l=l[l.length-1],!t[l]){var c="function"==typeof __require&&__require;if(!a&&c)return c(l,!0);if(r)return r(l,!0);throw new Error("Cannot find module '"+s+"'")}s=l}var u=o[s]={exports:{}};t[s][0].call(u.exports,function(e){return n(t[s][1][e]||e)},u,u.exports,e,t,o,i)}return o[s].exports}for(var r="function"==typeof __require&&__require,s=0;s<i.length;s++)n(i[s]);return n}({AnimatorBoardView:[function(e,t,o){"use strict";cc._RF.push(t,"ac83dH1vshLVrscAhBgfnwV","AnimatorBoardView");var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(n,r){function s(e){try{l(i.next(e))}catch(t){r(t)}}function a(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return l([e,t])}}function l(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(a){r=[6,a],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.AnimatorBoardView=void 0;var l=cc._decorator,c=l.ccclass,u=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.animationTileFallDuration=.25,t.animationSimpleTileCollapseDelay=.05,t.animationSwapDuration=.2,t.animationCollapseToMegaTileDuration=.3,t.animationCollapseToMegaTileScale=.3,t.animationMegaTileScaleUpDuration=.2,t.animationMegaTileScaleUpValue=1.3,t.animationMegaTileCommonScaleValue=1,t.animationDropNewDelayBetweenEach=.25,t.animationDropNewDuration=.35,t.animationCollapseSimpleTileDuration=.2,t.animationCollapseSimpleTileScaleDownValue=0,t}return n(t,e),t.prototype.setup=function(e,t){this.tileViews=e,this.boardView=t},t.prototype.animateSwap=function(e,t){var o,i;return s(this,void 0,Promise,function(){var n,r,s,l,c=this;return a(this,function(a){switch(a.label){case 0:return e&&t?(n=null===(o=this.tileViews.get(e.position.row+","+e.position.column))||void 0===o?void 0:o.node,r=null===(i=this.tileViews.get(t.position.row+","+t.position.column))||void 0===i?void 0:i.node,n&&r?(s=n.position.clone(),l=r.position.clone(),[4,Promise.all([new Promise(function(e){return cc.tween(n).to(c.animationSwapDuration,{position:l}).call(e).start()}),new Promise(function(e){return cc.tween(r).to(c.animationSwapDuration,{position:s}).call(e).start()})])]):[2]):[2];case 1:return a.sent(),[2]}})})},t.prototype.animateCollapsesToMegaTile=function(e,t){return s(this,void 0,Promise,function(){var o,i,n,r,s,l,c,u,p=this;return a(this,function(a){switch(a.label){case 0:for(o=[],i=this.boardView.getViewTilePosition(t.row,t.column),n=function(e){var t=r.tileViews.get(e.position.row+","+e.position.column);if(!t)return"continue";var n=t.node;o.push(new Promise(function(e){cc.tween(n).to(p.animationCollapseToMegaTileDuration,{position:new cc.Vec3(i.x,i.y),scale:p.animationCollapseToMegaTileScale},{easing:"backIn"}).call(function(){t.node.active=!1,e()}).start()}))},r=this,s=0,l=e;s<l.length;s++)c=l[s],n(c);return[4,Promise.all(o)];case 1:return a.sent(),(u=this.tileViews.get(t.row+","+t.column))?[4,new Promise(function(e){cc.tween(u.node).to(p.animationMegaTileScaleUpDuration,{scale:p.animationMegaTileScaleUpValue},{easing:"sineOut"}).to(p.animationMegaTileScaleUpDuration,{scale:p.animationMegaTileCommonScaleValue},{easing:"backIn"}).call(function(){e()}).start()})]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})},t.prototype.animateDropNew=function(e,t){return s(this,void 0,Promise,function(){var o,i=this;return a(this,function(n){switch(n.label){case 0:return o=[],e.forEach(function(e){if(e.fromRow===t){var n=i.tileViews.get(e.toRow+","+e.column).node,r=i.boardView.getViewTilePosition(e.toRow,e.column);o.push(new Promise(function(e){cc.tween(n).delay(i.animationDropNewDelayBetweenEach).to(i.animationDropNewDuration,{position:new cc.Vec3(r.x,r.y)},{easing:"bounceOut"}).call(function(){return e()}).start()}))}}),[4,Promise.all(o)];case 1:return n.sent(),[2]}})})},t.prototype.animateCollapses=function(e){return s(this,void 0,Promise,function(){var t,o=this;return a(this,function(i){switch(i.label){case 0:return t=[],e.forEach(function(e){var i=0,n=o.tileViews.get(e.position.row+","+e.position.column);n&&t.push(new Promise(function(e){cc.tween(n.node).to(o.animationCollapseSimpleTileDuration,{scale:o.animationCollapseSimpleTileScaleDownValue},{easing:"backIn"}).delay(i*o.animationSimpleTileCollapseDelay).call(function(){n.node.active=!1,e()}).start()})),i++}),[4,Promise.all(t)];case 1:return i.sent(),[2]}})})},t.prototype.animateFall=function(e,t){return s(this,void 0,Promise,function(){var o,i,n,r,s,l,c=this;return a(this,function(a){switch(a.label){case 0:for(o=[],this.animationTileFallDuration,i=function(e){if(e.fromRow==t)return"continue";var i=n.boardView.getViewTilePosition(e.toRow,e.column),r=n.tileViews.get(e.fromRow+","+e.column);null===r&&console.log("tileView is null");var s=r.node;s&&cc.isValid(s)&&o.push(new Promise(function(e){cc.tween(s).to(c.animationTileFallDuration,{position:new cc.Vec3(i.x,i.y)},{easing:"quadOut"}).call(function(){return e()}).start()}))},n=this,r=0,s=e;r<s.length;r++)l=s[r],i(l);return[4,Promise.all(o)];case 1:return a.sent(),[2]}})})},r([u(cc.Integer)],t.prototype,"animationTileFallDuration",void 0),r([u(cc.Integer)],t.prototype,"animationSimpleTileCollapseDelay",void 0),r([u(cc.Integer)],t.prototype,"animationSwapDuration",void 0),r([u(cc.Integer)],t.prototype,"animationCollapseToMegaTileDuration",void 0),r([u(cc.Integer)],t.prototype,"animationCollapseToMegaTileScale",void 0),r([u(cc.Integer)],t.prototype,"animationMegaTileScaleUpDuration",void 0),r([u(cc.Integer)],t.prototype,"animationMegaTileScaleUpValue",void 0),r([u(cc.Integer)],t.prototype,"animationMegaTileCommonScaleValue",void 0),r([u(cc.Integer)],t.prototype,"animationDropNewDelayBetweenEach",void 0),r([u(cc.Integer)],t.prototype,"animationDropNewDuration",void 0),r([u(cc.Integer)],t.prototype,"animationCollapseSimpleTileDuration",void 0),r([u(cc.Integer)],t.prototype,"animationCollapseSimpleTileScaleDownValue",void 0),r([c],t)}(cc.Component);o.AnimatorBoardView=p,cc._RF.pop()},{}],AssetLoader:[function(e,t,o){"use strict";cc._RF.push(t,"3ce4fYxbSpCA5e/Uhnko1IA","AssetLoader"),Object.defineProperty(o,"__esModule",{value:!0}),o.AssetLoader=void 0;var i=function(){function e(){}return e.loadAsset=function(e){return new Promise(function(t,o){cc.resources.load(e,cc.Prefab,function(e,i){e?o(e):t(i)})})},e}();o.AssetLoader=i,cc._RF.pop()},{}],AssetsPath:[function(e,t,o){"use strict";cc._RF.push(t,"86537JcDbNHOZhRGsZWrIQj","AssetsPath"),Object.defineProperty(o,"__esModule",{value:!0}),o.AssetsPath=void 0;var i=function(){function e(){}return e.LevelView="prefabs/level/levelView",e.TileView="prefabs/tile/tileView",e.GameConfig="config/gameConfig",e.TileSpriteDataBase="config/tileSpriteService",e}();o.AssetsPath=i,cc._RF.pop()},{}],BoardView:[function(e,t,o){"use strict";cc._RF.push(t,"530afNjH7hPeZgPwDNGEPFe","BoardView");var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(n,r){function s(e){try{l(i.next(e))}catch(t){r(t)}}function a(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return l([e,t])}}function l(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(a){r=[6,a],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.BoardView=void 0;var l=e("../model/Tile"),c=e("./AnimatorBoardView"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.debugBoard=null,t.animator=null,t.animationBeforeCreateTileDelay=200,t._onTileClick=null,t}return n(t,e),t.prototype.initialize=function(e,t,o,i,n,r,s){this.horizontalTileCount=t,this.verticalTileCount=o,this.tileWidth=i,this.tileHeight=n,this._onTileClick=s,this.board=r,this.tileViewFactory=e,this.tileViews=new Map,this.setupView(t,i,o,n);for(var a=0;a<o;a++)for(var l=0;l<t;l++){var c=this.tileViewFactory.createTileView(this.node);c.init(r.grid[a][l],this.getViewTilePosition(a,l),new cc.Vec2(i,n),this.handleTileClick.bind(this)),this.tileViews.set(a+","+l,c)}this.updateRenderOrder(o,t),this.animator.setup(this.tileViews,this)},t.prototype.updateView=function(e){return s(this,void 0,Promise,function(){return a(this,function(t){switch(t.label){case 0:return[4,this.animator.animateSwap(e.swapTile[0],e.swapTile[1])];case 1:return t.sent(),this.updateSwapTiles(e.swapTile[0],e.swapTile[1]),e.createdMegaTile?[4,this.animator.animateCollapsesToMegaTile(e.collapseTiles,e.createdMegaTileStartPosition)]:[3,3];case 2:return t.sent(),this.updateMegaTileView(e.createdMegaTile,e.createdMegaTileStartPosition),[3,5];case 3:return[4,this.animator.animateCollapses(e.collapseTiles)];case 4:t.sent(),t.label=5;case 5:return[4,this.delay(this.animationBeforeCreateTileDelay)];case 6:return t.sent(),this.updateCollapsedTiles(e.collapseTiles),[4,this.animator.animateFall(e.dropMoves,this.board.config.verticalTileCount)];case 7:return t.sent(),this.updateFallenTiles(e.dropMoves),this.addNewTileViews(e),[4,this.animator.animateDropNew(e.dropMoves,this.board.config.verticalTileCount)];case 8:return t.sent(),[2]}})})},t.prototype.setupView=function(e,t,o,i){this.node.width=e*t,this.node.height=o*i},t.prototype.updateRenderOrder=function(e,t){for(var o=e*t+1,i=0;i<e;i++)for(var n=0;n<t;n++)this.tileViews.get(i+","+n).node.setSiblingIndex(o),o--},t.prototype.handleTileClick=function(e){this._onTileClick&&this._onTileClick(e)},t.prototype.updateFallenTiles=function(e){for(var t=0,o=e;t<o.length;t++){var i=o[t];if(i.fromRow!=this.board.config.verticalTileCount){var n=this.tileViews.get(i.fromRow+","+i.column);null===n&&console.log("tileView is null"),this.tileViews.delete(i.fromRow+","+i.column),this.tileViews.set(i.toRow+","+i.column,n),n.updateView(i.tile)}}},t.prototype.updateSwapTiles=function(e,t){if(e&&t){var o=this.tileViews.get(e.position.row+","+e.position.column),i=this.tileViews.get(t.position.row+","+t.position.column);this.tileViews.delete(e.position.row+","+e.position.column),this.tileViews.delete(t.position.row+","+t.position.column),this.tileViews.set(e.position.row+","+e.position.column,i),this.tileViews.set(t.position.row+","+t.position.column,o),o.updateView(t),i.updateView(e)}},t.prototype.updateMegaTileView=function(e,t){var o=this.tileViews.get(t.row+","+t.column);o&&o.updateView(e)},t.prototype.updateCollapsedTiles=function(e){for(var t=0,o=e;t<o.length;t++){var i=o[t],n=this.tileViews.get(i.position.row+","+i.position.column);this.tileViews.delete(i.position.row+","+i.position.column),this.tileViewFactory.dispose(n)}},t.prototype.addNewTileViews=function(e){for(var t=0;t<e.config.verticalTileCount;t++)for(var o=0;o<e.config.horizontalTileCount;o++)if(!this.tileViews.has(t+","+o)){var i=e.grid[t][o],n=this.tileViewFactory.createTileView(this.node),r=this.getViewTilePosition(-1,o);n.init(i,new l.Position(r.x,r.y,t,o),new cc.Vec2(this.tileWidth,this.tileHeight),this.handleTileClick.bind(this)),this.tileViews.set(t+","+o,n)}this.updateRenderOrder(e.config.verticalTileCount,e.config.horizontalTileCount)},t.prototype.getViewTilePosition=function(e,t){var o=this.node.getPosition(),i=this.tileWidth*this.horizontalTileCount,n=this.tileHeight*this.verticalTileCount,r=o.x-i/2,s=o.y+n/2,a=r+t*this.tileWidth+this.tileWidth/2,c=s-e*this.tileHeight-this.tileHeight/2;return new l.Position(a,c,e,t)},t.prototype.printGrid=function(){for(var e="",t=0;t<this.board.config.verticalTileCount;t++){for(var o=0;o<this.board.config.horizontalTileCount;o++)e+="["+t+","+o+"]"+this.board.grid[t][o].type+" ";e+="\n"}this.debugBoard.string=e},t.prototype.delay=function(e){return new Promise(function(t){return setTimeout(t,e)})},r([h(cc.Label)],t.prototype,"debugBoard",void 0),r([h(c.AnimatorBoardView)],t.prototype,"animator",void 0),r([h(cc.Integer)],t.prototype,"animationBeforeCreateTileDelay",void 0),r([p],t)}(cc.Component);o.BoardView=f,cc._RF.pop()},{"../model/Tile":"Tile","./AnimatorBoardView":"AnimatorBoardView"}],Board:[function(e,t,o){"use strict";cc._RF.push(t,"1a821v74ElCrpV8NiddZkJq","Board"),Object.defineProperty(o,"__esModule",{value:!0}),o.Board=void 0;var i=e("./Tile"),n=function(){function e(e,t){this.config=e,this.tileFactory=t,this.initializeGrid()}return e.prototype.initializeGrid=function(){this.grid=[];for(var e=0;e<this.config.verticalTileCount;e++){this.grid[e]=[];for(var t=0;t<this.config.horizontalTileCount;t++)this.grid[e][t]=this.tileFactory.createNormalTile(this.getPositionBy(e,t))}this.clearDropMoves()},e.prototype.setCollapseTiles=function(e){this.collapseTiles=e},e.prototype.addDropMoves=function(e){this.dropMoves=e},e.prototype.clearDropMoves=function(){this.collapseTiles=[],this.dropMoves=[],this.swapTile=[null,null],this.createdMegaTileStartPosition=null,this.createdMegaTile=null},e.prototype.createMegaTile=function(e){this.createdMegaTileStartPosition=e,this.grid[e.row][e.column]=this.tileFactory.createTileMegaTile(e),this.createdMegaTile=this.grid[e.row][e.column]},e.prototype.getTileAt=function(e){return this.isPositionValid(e)?this.grid[e.row][e.column]:null},e.prototype.removeTiles=function(e){var t=this;e.forEach(function(e){t.isPositionValid(e)&&(t.grid[e.row][e.column]=null)}),this.collapseColumns(),this.fillEmptySpaces()},e.prototype.getPositionBy=function(e,t){return new i.Position(0,0,e,t)},e.prototype.getTopNeighborsPosition=function(e){return 0==e.row?null:this.getPositionBy(e.row-1,e.column)},e.prototype.getBottomNeighborsPosition=function(e){return e.row==this.config.verticalTileCount-1?null:this.getPositionBy(e.row+1,e.column)},e.prototype.getLeftNeighborsPosition=function(e){return 0==e.column?null:this.getPositionBy(e.row,e.column-1)},e.prototype.getRightNeighborsPosition=function(e){return e.column==this.config.horizontalTileCount-1?null:this.getPositionBy(e.row,e.column+1)},e.prototype.isPositionValid=function(e){return!!e&&e.row>=0&&e.row<this.config.verticalTileCount&&e.column>=0&&e.column<this.config.horizontalTileCount},e.prototype.collapseColumns=function(){for(var e=0;e<this.config.horizontalTileCount;e++)for(var t=this.config.verticalTileCount,o=this.config.verticalTileCount-1;o>=0;o--)if(null===this.grid[o][e]&&t===this.config.verticalTileCount)t=o;else if(null!==this.grid[o][e]&&t!==this.config.verticalTileCount)for(this.grid[t][e]=this.grid[o][e],this.grid[t][e].position=new i.Position(0,0,t,e),this.grid[o][e]=null,this.dropMoves.push({tile:this.grid[t][e],fromRow:o,toRow:t,column:e});t>=0&&null!==this.grid[t][e];)t--},e.prototype.fillEmptySpaces=function(){for(var e=0;e<this.config.verticalTileCount;e++)for(var t=0;t<this.config.horizontalTileCount;t++)if(null===this.grid[e][t]){var o=this.getPositionBy(e,t);this.grid[e][t]=this.tileFactory.createNormalTile(o),this.dropMoves.push({tile:this.grid[e][t],fromRow:this.config.verticalTileCount,toRow:e,column:t})}},e}();o.Board=n,cc._RF.pop()},{"./Tile":"Tile"}],BoosterHandler:[function(e,t,o){"use strict";cc._RF.push(t,"418156Xxs1Ejpsn2VS6QOT0","BoosterHandler"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterHandler=void 0;var i=e("./BoosterType"),n=e("../view/BoosterView"),r=function(){function e(e,t,o,n,r){this.boosterView=null,this.board=e,this.activeBooster=i.BoosterType.None,this.scoreCounter=t,this.boosterView=o,this.boosterBombCount=r,this.boosterTeleportCount=n,this.subscribesToBoosterButtonsEvent(),this.boosterView.updateView(this.boosterTeleportCount,this.boosterBombCount)}return e.prototype.isSelectedBooster=function(){return this.activeBooster!==i.BoosterType.None},e.prototype.selectBooster=function(e){this.activeBooster=e},e.prototype.useActiveBoosterIn=function(e){this.handleBooster(e)},e.prototype.unblockBoosters=function(){this.subscribesToBoosterButtonsEvent()},e.prototype.blockBoosters=function(){this.unsubscribesFromBoosterButtonsEvent()},e.prototype.subscribesToBoosterButtonsEvent=function(){this.boosterView.node.on(n.BoosterView.TeleportTapEventName,this.onTapTeleportButton,this),this.boosterView.node.on(n.BoosterView.BombTapEventName,this.onTapBoombButton,this)},e.prototype.unsubscribesFromBoosterButtonsEvent=function(){this.boosterView.node.off(n.BoosterView.TeleportTapEventName,this.onTapTeleportButton,this),this.boosterView.node.off(n.BoosterView.BombTapEventName,this.onTapBoombButton,this)},e.prototype.handleBooster=function(e){switch(this.activeBooster){case i.BoosterType.Teleport:null==this.firstSelectionTile?this.firstSelectionTile=e:(this.secondSelectionTile=e,this.teleportTiles(),this.boosterTeleportCount--,this.boosterView.updateView(this.boosterTeleportCount,this.boosterBombCount),this.offActive());break;case i.BoosterType.Bomb:this.bombTile(e),this.boosterBombCount--,this.boosterView.updateView(this.boosterTeleportCount,this.boosterBombCount),this.offActive()}this.boosterTeleportCount<=0&&this.boosterView.disableTeleport(),this.boosterBombCount<=0&&this.boosterView.disableBomb()},e.prototype.offActive=function(){this.firstSelectionTile=null,this.secondSelectionTile=null,this.activeBooster=i.BoosterType.None,this.boosterView.setActiveBooster(i.BoosterType.None)},e.prototype.bombTile=function(e){for(var t=[],o=[e.position.row,e.position.column],i=o[0],n=o[1],r=this.board.config.superTileRadius,s=i-r;s<=i+r;s++)for(var a=n-r;a<=n+r;a++)s>=0&&s<this.board.config.verticalTileCount&&a>=0&&a<this.board.config.horizontalTileCount&&t.push(this.board.grid[s][a]);this.board.setCollapseTiles(t),this.board.removeTiles(t.map(function(e){return e.position})),this.scoreCounter.updateScore(t)},e.prototype.teleportTiles=function(){var e=[this.firstSelectionTile.position.row,this.firstSelectionTile.position.column],t=e[0],o=e[1],i=[this.secondSelectionTile.position.row,this.secondSelectionTile.position.column],n=i[0],r=i[1],s=this.board.grid[t][o];this.board.grid[t][o]=this.board.grid[n][r],this.board.grid[n][r]=s;var a=this.board.grid[t][o].position;this.board.grid[t][o].position=this.board.grid[n][r].position,this.board.grid[n][r].position=a,this.board.swapTile=[this.firstSelectionTile,this.secondSelectionTile]},e.prototype.onTapBoombButton=function(){this.activeBooster===i.BoosterType.Bomb?this.offActive():(this.activeBooster=i.BoosterType.Bomb,this.boosterView.setActiveBooster(i.BoosterType.Bomb))},e.prototype.onTapTeleportButton=function(){this.activeBooster===i.BoosterType.Teleport?this.offActive():(this.activeBooster=i.BoosterType.Teleport,this.boosterView.setActiveBooster(i.BoosterType.Teleport))},e}();o.BoosterHandler=r,cc._RF.pop()},{"../view/BoosterView":"BoosterView","./BoosterType":"BoosterType"}],BoosterType:[function(e,t,o){"use strict";cc._RF.push(t,"b79a6v9ucZFcoV1/+WxqV8f","BoosterType"),Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterType=void 0,function(e){e[e.None=0]="None",e[e.Teleport=1]="Teleport",e[e.Bomb=2]="Bomb"}(o.BoosterType||(o.BoosterType={})),cc._RF.pop()},{}],BoosterView:[function(e,t,o){"use strict";cc._RF.push(t,"aab338D57FKd6NJNJAyRtey","BoosterView");var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.BoosterView=void 0;var s=e("../model/BoosterType"),a=cc._decorator,l=a.ccclass,c=a.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.teleportCount=null,t.bombCount=null,t.teleportButton=null,t.bombButton=null,t.emptyBoosterOpacity=100,t.animationScaleUpDuration=.4,t.animationScaleUpValue=1.15,t.animationScaleDownDuration=.4,t.animationScaleDownValue=1,t}var o;return n(t,e),o=t,t.prototype.updateView=function(e,t){this.teleportCount.string=""+e,this.bombCount.string=""+t},t.prototype.setActiveBooster=function(e){switch(e){case s.BoosterType.Bomb:this.dismissHightlights(),this.selectedBoosterNode=this.bombButton.node,this.hightlightSelection(this.selectedBoosterNode);break;case s.BoosterType.Teleport:this.dismissHightlights(),this.selectedBoosterNode=this.teleportButton.node,this.hightlightSelection(this.selectedBoosterNode);break;case s.BoosterType.None:this.dismissHightlights(),this.selectedBoosterNode=null}},t.prototype.disableTeleport=function(){this.teleportButton.node.opacity=this.emptyBoosterOpacity,this.unsubscribeFromTeleportButton()},t.prototype.disableBomb=function(){this.bombButton.node.opacity=this.emptyBoosterOpacity,this.unsubscribeFromBombButton()},t.prototype.dismissHightlights=function(){this.selectedBoosterNode&&(this.selectedBoosterNode.stopAllActions(),this.selectedBoosterNode.scale=1)},t.prototype.onLoad=function(){this.subscribeToBombButton(),this.subscribeToTeleportButton()},t.prototype.subscribeToTeleportButton=function(){this.teleportButton.node.on(cc.Node.EventType.TOUCH_END,this.onTapTeleportButton,this)},t.prototype.subscribeToBombButton=function(){this.bombButton.node.on(cc.Node.EventType.TOUCH_END,this.onTapBoombButton,this)},t.prototype.unsubscribeFromTeleportButton=function(){this.teleportButton.node.off(cc.Node.EventType.TOUCH_END,this.onTapTeleportButton,this)},t.prototype.unsubscribeFromBombButton=function(){this.bombButton.node.off(cc.Node.EventType.TOUCH_END,this.onTapBoombButton,this)},t.prototype.onDestroy=function(){this.unsubscribeFromTeleportButton(),this.unsubscribeFromBombButton()},t.prototype.hightlightSelection=function(e){this.selectedBoosterNode=e,cc.tween(e).repeatForever(cc.tween().to(this.animationScaleUpDuration,{scale:this.animationScaleUpValue},{easing:"sineOut"}).to(this.animationScaleDownDuration,{scale:this.animationScaleDownValue},{easing:"sineIn"})).start()},t.prototype.onTapBoombButton=function(){this.node.emit(o.BombTapEventName)},t.prototype.onTapTeleportButton=function(){this.node.emit(o.TeleportTapEventName)},t.BombTapEventName="onTapBoombButton",t.TeleportTapEventName="onTapTeleportButton",r([c(cc.Label)],t.prototype,"teleportCount",void 0),r([c(cc.Label)],t.prototype,"bombCount",void 0),r([c(cc.Button)],t.prototype,"teleportButton",void 0),r([c(cc.Button)],t.prototype,"bombButton",void 0),r([c(cc.Integer)],t.prototype,"emptyBoosterOpacity",void 0),r([c(cc.Integer)],t.prototype,"animationScaleUpDuration",void 0),r([c(cc.Integer)],t.prototype,"animationScaleUpValue",void 0),r([c(cc.Integer)],t.prototype,"animationScaleDownDuration",void 0),r([c(cc.Integer)],t.prototype,"animationScaleDownValue",void 0),o=r([l],t)}(cc.Component);o.BoosterView=u,cc._RF.pop()},{"../model/BoosterType":"BoosterType"}],EntryPoint:[function(e,t,o){"use strict";cc._RF.push(t,"43502h+OWJCh6n030o8uGh3","EntryPoint");var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},s=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(n,r){function s(e){try{l(i.next(e))}catch(t){r(t)}}function a(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return l([e,t])}}function l(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(a){r=[6,a],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.EntryPoint=void 0;var l=e("../AssetsPath"),c=e("../config/GameConfigPrefab"),u=e("../controller/GameContoller"),p=e("../factory/LevelViewFactory"),h=e("../factory/TileViewFactory"),f=e("../service/AssetLoader"),d=cc._decorator,v=d.ccclass,y=d.property,m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.gameNode=null,t.levelParent=null,t}return n(t,e),t.prototype.onLoad=function(){return s(this,void 0,Promise,function(){return a(this,function(e){switch(e.label){case 0:return[4,this.loadConfigAssets()];case 1:return e.sent(),this.initConfig(),[4,this.loadFactoryAssets()];case 2:return e.sent(),this.initGameContoller(),[2]}})})},t.prototype.initConfig=function(){this.config={boosterTeleportCount:this.gameConfigNode.boosterTeleportCount,boosterBombCount:this.gameConfigNode.boosterBombCount,tileScore:this.gameConfigNode.tileScore,tileWidth:this.gameConfigNode.tileWidth,tileHeight:this.gameConfigNode.tileHeight,horizontalTileCount:this.gameConfigNode.horizontalTileCount,verticalTileCount:this.gameConfigNode.verticalTileCount,maxMoves:this.gameConfigNode.maxMoves,targetScore:this.gameConfigNode.targetScore,superTileThreshold:this.gameConfigNode.superTileThreshold,bombRadius:this.gameConfigNode.bombRadius,superTileRadius:this.gameConfigNode.superTileRadius}},t.prototype.loadConfigAssets=function(){return s(this,void 0,Promise,function(){var e,t;return a(this,function(o){switch(o.label){case 0:return[4,f.AssetLoader.loadAsset(l.AssetsPath.GameConfig)];case 1:return e=o.sent(),this.gameConfigNode=cc.instantiate(e).getComponent(c.GameConfigPrefab),[4,f.AssetLoader.loadAsset(l.AssetsPath.TileSpriteDataBase)];case 2:return t=o.sent(),cc.instantiate(t).setParent(this.gameNode),[2]}})})},t.prototype.loadFactoryAssets=function(){return s(this,void 0,Promise,function(){var e,t;return a(this,function(o){switch(o.label){case 0:return[4,f.AssetLoader.loadAsset(l.AssetsPath.LevelView)];case 1:return e=o.sent(),[4,f.AssetLoader.loadAsset(l.AssetsPath.TileView)];case 2:return t=o.sent(),this.tileViewFactory=new h.TileViewFactory(t),this.levelViewFactory=new p.LevelViewFactory(e,this.levelParent,this.config),[2]}})})},t.prototype.initGameContoller=function(){this.gameController=new u.GameController(this.config,this.levelViewFactory,this.tileViewFactory,this.gameNode),this.gameController.nextLevel()},r([y(cc.Node)],t.prototype,"gameNode",void 0),r([y(cc.Node)],t.prototype,"levelParent",void 0),r([v],t)}(cc.Component);o.EntryPoint=m,cc._RF.pop()},{"../AssetsPath":"AssetsPath","../config/GameConfigPrefab":"GameConfigPrefab","../controller/GameContoller":"GameContoller","../factory/LevelViewFactory":"LevelViewFactory","../factory/TileViewFactory":"TileViewFactory","../service/AssetLoader":"AssetLoader"}],EventEmitter:[function(e,t,o){"use strict";cc._RF.push(t,"a7907zqaRxIQ7eMMueJvKiR","EventEmitter"),Object.defineProperty(o,"__esModule",{value:!0});var i=function(){function e(){this.listeners={}}return e.prototype.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},e.prototype.off=function(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(function(e){return e!==t}))},e.prototype.emit=function(e,t){this.listeners[e]&&this.listeners[e].forEach(function(e){return e(t)})},e}();o.default=i,cc._RF.pop()},{}],GameConfigPrefab:[function(e,t,o){"use strict";cc._RF.push(t,"23ce41yoDJEkKstg/P1h8nt","GameConfigPrefab");var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.GameConfigPrefab=void 0;var s=cc._decorator,a=s.ccclass,l=s.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tileScore=10,t.tileWidth=64,t.tileHeight=64,t.horizontalTileCount=4,t.verticalTileCount=4,t.maxMoves=5,t.targetScore=100,t.superTileThreshold=3,t.bombRadius=2,t.superTileRadius=2,t.boosterTeleportCount=5,t.boosterBombCount=5,t}return n(t,e),r([l(cc.Integer)],t.prototype,"tileScore",void 0),r([l(cc.Integer)],t.prototype,"tileWidth",void 0),r([l(cc.Integer)],t.prototype,"tileHeight",void 0),r([l(cc.Integer)],t.prototype,"horizontalTileCount",void 0),r([l(cc.Integer)],t.prototype,"verticalTileCount",void 0),r([l(cc.Integer)],t.prototype,"maxMoves",void 0),r([l(cc.Integer)],t.prototype,"targetScore",void 0),r([l(cc.Integer)],t.prototype,"superTileThreshold",void 0),r([l(cc.Integer)],t.prototype,"bombRadius",void 0),r([l(cc.Integer)],t.prototype,"superTileRadius",void 0),r([l(cc.Integer)],t.prototype,"boosterTeleportCount",void 0),r([l(cc.Integer)],t.prototype,"boosterBombCount",void 0),r([a],t)}(cc.Component);o.GameConfigPrefab=c,cc._RF.pop()},{}],GameConfig:[function(e,t,o){"use strict";cc._RF.push(t,"ce6c2QwDF9D/ZuBQXYjCmt+","GameConfig"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],GameContoller:[function(e,t,o){"use strict";cc._RF.push(t,"7e4cboBm0FG9KGM2n36Tmbw","GameContoller"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameController=void 0;var i=e("../GameEvents"),n=e("../model/GameState"),r=e("../view/GameView"),s=e("./LevelController"),a=function(){function e(e,t,o,s){var a=this;this.handleWinLevel=function(){a.levelWin()},this.handleLoseLevel=function(){a.levelLose()},this.config=e,this.levelViewFactory=t,this.tileViewFactory=o,this.gameNode=s,this.state=n.GameState.initial(e),this.gameView=this.gameNode.getComponent(r.GameView),this.gameView.node.on(i.RestartEventName,this.onTapRestartButton,this)}return e.prototype.nextLevel=function(){this.gameView.hideLose(),this.gameView.hideWin(),this.level&&(this.level.gameEventEmitter.off(i.LevelWinEvent,this.handleWinLevel.bind(this)),this.level.gameEventEmitter.off(i.LevelLoseEvent,this.handleLoseLevel.bind(this)),this.disposeLevel());var e=this.levelViewFactory.createLevel();e.init(this.config.targetScore,this.config.maxMoves),this.level=new s.LevelController(e,this.config,this.tileViewFactory,this.state),this.level.gameEventEmitter.on(i.LevelWinEvent,this.handleWinLevel.bind(this)),this.level.gameEventEmitter.on(i.LevelLoseEvent,this.handleLoseLevel.bind(this))},e.prototype.disposeLevel=function(){this.level.hide(),this.level.destroy()},e.prototype.levelLose=function(){this.gameView.showLose()},e.prototype.levelWin=function(){this.gameView.showWin()},e.prototype.onTapRestartButton=function(){this.state.reset(this.config),this.nextLevel()},e}();o.GameController=a,cc._RF.pop()},{"../GameEvents":"GameEvents","../model/GameState":"GameState","../view/GameView":"GameView","./LevelController":"LevelController"}],GameEvents:[function(e,t,o){"use strict";cc._RF.push(t,"43ffeoRsa5CjId8TJ3Bm9v8","GameEvents"),Object.defineProperty(o,"__esModule",{value:!0}),o.RestartEventName=o.LevelLoseEvent=o.LevelWinEvent=o.MovesChangedEvent=o.ScoreChangedEvent=void 0,o.ScoreChangedEvent="score-changed",o.MovesChangedEvent="moves-changed",o.LevelWinEvent="level-win",o.LevelLoseEvent="level-lose",o.RestartEventName="restart",cc._RF.pop()},{}],GameState:[function(e,t,o){"use strict";cc._RF.push(t,"b003aEUrJtD6LP5NpPOQFrY","GameState"),Object.defineProperty(o,"__esModule",{value:!0}),o.GameState=void 0;var i=e("../EventEmitter"),n=e("../GameEvents"),r=function(){function e(e,t,o,n,r,s){this.gameEventEmitter=new i.default,this.winScore=e,this.score=t,this.movesLeft=o,this.isLevelLose=n,this.isLevelWin=r,this.shuffleCount=s}return e.initial=function(t){return new e(t.targetScore,0,t.maxMoves,!1,!1,0)},e.prototype.updateScore=function(e){this.score=e,this.gameEventEmitter.emit(n.ScoreChangedEvent,{score:this.score}),this.score>=this.winScore&&(this.isLevelWin=!0)},e.prototype.updateMovesLeft=function(e){this.movesLeft=e,this.gameEventEmitter.emit(n.MovesChangedEvent,{moves:this.movesLeft}),this.movesLeft<=0&&(this.isLevelLose=!0)},e.prototype.reset=function(e){this.score=0,this.movesLeft=e.maxMoves,this.isLevelLose=!1,this.isLevelWin=!1,this.shuffleCount=0},e}();o.GameState=r,cc._RF.pop()},{"../EventEmitter":"EventEmitter","../GameEvents":"GameEvents"}],GameView:[function(e,t,o){"use strict";cc._RF.push(t,"5e317ir4GJLLIs5dydg/HCa","GameView");var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.GameView=void 0;var s=e("../GameEvents"),a=cc._decorator,l=a.ccclass,c=a.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.winNode=null,t.loseNode=null,t.loseRestartButton=null,t.winRestartButton=null,t}return n(t,e),t.prototype.showWin=function(){this.loseNode.active=!1,this.winNode.active=!0},t.prototype.showLose=function(){this.winNode.active=!1,this.loseNode.active=!0},t.prototype.hideWin=function(){this.winNode.active=!1},t.prototype.hideLose=function(){this.loseNode.active=!1},t.prototype.onLoad=function(){this.loseRestartButton.node.on(cc.Node.EventType.TOUCH_END,this.onTapRestartButton,this),this.winRestartButton.node.on(cc.Node.EventType.TOUCH_END,this.onTapRestartButton,this)},t.prototype.onDestroy=function(){this.loseRestartButton.node.off(cc.Node.EventType.TOUCH_END,this.onTapRestartButton,this),this.winRestartButton.node.off(cc.Node.EventType.TOUCH_END,this.onTapRestartButton,this)},t.prototype.onTapRestartButton=function(){this.node.emit(s.RestartEventName)},r([c(cc.Node)],t.prototype,"winNode",void 0),r([c(cc.Node)],t.prototype,"loseNode",void 0),r([c(cc.Button)],t.prototype,"loseRestartButton",void 0),r([c(cc.Button)],t.prototype,"winRestartButton",void 0),r([l],t)}(cc.Component);o.GameView=u,cc._RF.pop()},{"../GameEvents":"GameEvents"}],LevelController:[function(e,t,o){"use strict";cc._RF.push(t,"0c328+RSDZGBbXvOFhoYBw1","LevelController");var i=this&&this.__awaiter||function(e,t,o,i){return new(o||(o=Promise))(function(n,r){function s(e){try{l(i.next(e))}catch(t){r(t)}}function a(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof o?t:new o(function(e){e(t)})).then(s,a)}l((i=i.apply(e,t||[])).next())})},n=this&&this.__generator||function(e,t){var o,i,n,r,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(e){return function(t){return l([e,t])}}function l(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(n=2&r[0]?i.return:r[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,r[1])).done)return n;switch(i=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){s.label=r[1];break}if(6===r[0]&&s.label<n[1]){s.label=n[1],n=r;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(r);break}n[2]&&s.ops.pop(),s.trys.pop();continue}r=t.call(e,s)}catch(a){r=[6,a],i=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.LevelController=void 0;var r=e("../EventEmitter"),s=e("../factory/TileFactory"),a=e("../GameEvents"),l=e("../model/Board"),c=e("../model/BoosterHandler"),u=e("../model/BoosterType"),p=e("../model/MoveCounter"),h=e("../model/ScoreCounter"),f=e("../model/SimpleTileHandler"),d=e("../model/SuperTileHandler"),v=e("../model/TileMatcher"),y=e("../view/BoosterView"),m=function(){function e(e,t,o,i){var n=this;this.gameEventEmitter=new r.default,this.handleMovesChanged=function(e){n.levelView.updateMoves(e.moves)},this.handleScoreChanged=function(e){n.levelView.updateScore(e.score)},this.state=i;var u=new h.ScoreCounter(t.tileScore,this.state),m=new p.MoveCounter(t.maxMoves,this.state),T=new s.TileFactory;this.board=new l.Board(t,T),this.tileMatcher=new v.TileMatcher(t,this.board),this.simpleTileHandler=new f.SimpleTileHandler(this.board,u,m,this.tileMatcher,t.superTileThreshold),this.superTileHandler=new d.SuperTileHandler(this.board,u,m),this.boosterHandler=new c.BoosterHandler(this.board,u,e.boosterView,t.boosterTeleportCount,t.boosterBombCount),this.levelView=e,this.levelView.boardView.initialize(o,t.horizontalTileCount,t.verticalTileCount,t.tileWidth,t.tileHeight,this.board,this.handleTileClick.bind(this)),this.levelView.node.on(y.BoosterView.BombTapEventName,this.handleBoombButton,this),this.levelView.node.on(y.BoosterView.TeleportTapEventName,this.handleTeleportButton,this),this.state.gameEventEmitter.on(a.ScoreChangedEvent,this.handleScoreChanged),this.state.gameEventEmitter.on(a.MovesChangedEvent,this.handleMovesChanged)}return e.prototype.destroy=function(){this.state.gameEventEmitter.off(a.ScoreChangedEvent,this.handleScoreChanged),this.state.gameEventEmitter.off(a.MovesChangedEvent,this.handleMovesChanged),this.levelView.node.off(y.BoosterView.BombTapEventName,this.handleBoombButton,this),this.levelView.node.off(y.BoosterView.TeleportTapEventName,this.handleTeleportButton,this),this.levelView.destroy()},e.prototype.hide=function(){this.levelView.hide()},e.prototype.selectTile=function(e){return i(this,void 0,Promise,function(){var t;return n(this,function(o){switch(o.label){case 0:return this.state.isLevelLose||this.state.isLevelWin?[2]:(t=this.board.getTileAt(e))?this.updateInProgress?[2]:(this.boosterHandler.isSelectedBooster()?this.boosterHandler.useActiveBoosterIn(t):t.isSuperTile()?this.superTileHandler.handleSuperTile(t):this.simpleTileHandler.handleSimpleTile(t),this.updateInProgress=!0,this.boosterHandler.blockBoosters(),[4,this.levelView.boardView.updateView(this.board,t)]):[2];case 1:return o.sent(),this.updateInProgress=!1,this.boosterHandler.unblockBoosters(),this.boosterHandler.isSelectedBooster()||this.board.clearDropMoves(),this.state.isLevelLose?this.gameEventEmitter.emit(a.LevelLoseEvent,null):this.state.isLevelWin&&this.gameEventEmitter.emit(a.LevelWinEvent,null),[2]}})})},e.prototype.handleTeleportButton=function(){this.boosterHandler.selectBooster(u.BoosterType.Teleport)},e.prototype.handleBoombButton=function(){this.boosterHandler.selectBooster(u.BoosterType.Bomb)},e.prototype.handleTileClick=function(e){return i(this,void 0,Promise,function(){return n(this,function(t){switch(t.label){case 0:return[4,this.selectTile(e)];case 1:return t.sent(),[2]}})})},e}();o.LevelController=m,cc._RF.pop()},{"../EventEmitter":"EventEmitter","../GameEvents":"GameEvents","../factory/TileFactory":"TileFactory","../model/Board":"Board","../model/BoosterHandler":"BoosterHandler","../model/BoosterType":"BoosterType","../model/MoveCounter":"MoveCounter","../model/ScoreCounter":"ScoreCounter","../model/SimpleTileHandler":"SimpleTileHandler","../model/SuperTileHandler":"SuperTileHandler","../model/TileMatcher":"TileMatcher","../view/BoosterView":"BoosterView"}],LevelViewFactory:[function(e,t,o){"use strict";cc._RF.push(t,"a01f68dqdpMbpFf1UNqzuqx","LevelViewFactory"),Object.defineProperty(o,"__esModule",{value:!0}),o.LevelViewFactory=void 0;var i=e("../view/LevelView"),n=function(){function e(e,t,o){this.prefab=e,this.parent=t,this.config=o}return e.prototype.createLevel=function(){var e=cc.instantiate(this.prefab);e.setParent(this.parent);var t=e.getComponent(i.LevelView);return t.init(this.config.targetScore,this.config.maxMoves),t},e}();o.LevelViewFactory=n,cc._RF.pop()},{"../view/LevelView":"LevelView"}],LevelView:[function(e,t,o){"use strict";cc._RF.push(t,"c2211F9+VJLw4BCnwigv+l+","LevelView");var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.LevelView=void 0;var s=e("./BoardView"),a=e("./BoosterView"),l=e("./MoveCounterView"),c=e("./ScoreCounterView"),u=cc._decorator,p=u.ccclass,h=u.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreCounterView=null,t.moveCounterView=null,t.boardView=null,t.boosterView=null,t}return n(t,e),t.prototype.init=function(e,t){this.scoreCounterView.init(e),this.moveCounterView.updateMoves(t)},t.prototype.hide=function(){this.node.active=!1},t.prototype.updateScore=function(e){this.scoreCounterView.updateScore(e)},t.prototype.updateMoves=function(e){this.moveCounterView.updateMoves(e)},t.prototype.onTapBoombButton=function(){this.node.emit(a.BoosterView.BombTapEventName)},t.prototype.onTapTeleportButton=function(){this.node.emit(a.BoosterView.TeleportTapEventName)},r([h(c.ScoreCounterView)],t.prototype,"scoreCounterView",void 0),r([h(l.MoveCounterView)],t.prototype,"moveCounterView",void 0),r([h(s.BoardView)],t.prototype,"boardView",void 0),r([h(a.BoosterView)],t.prototype,"boosterView",void 0),r([p],t)}(cc.Component);o.LevelView=f,cc._RF.pop()},{"./BoardView":"BoardView","./BoosterView":"BoosterView","./MoveCounterView":"MoveCounterView","./ScoreCounterView":"ScoreCounterView"}],MoveCounterView:[function(e,t,o){"use strict";cc._RF.push(t,"cf671kwbmBJR6vkaeojnLcA","MoveCounterView");var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.MoveCounterView=void 0;var s=cc._decorator,a=s.ccclass,l=s.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.movesLabel=null,t}return n(t,e),t.prototype.updateMoves=function(e){this.movesLabel.string=e.toString()},r([l(cc.Label)],t.prototype,"movesLabel",void 0),r([a],t)}(cc.Component);o.MoveCounterView=c,cc._RF.pop()},{}],MoveCounter:[function(e,t,o){"use strict";cc._RF.push(t,"9ebf9ww0fpBJ5sX520O6gDL","MoveCounter"),Object.defineProperty(o,"__esModule",{value:!0}),o.MoveCounter=void 0;var i=function(){function e(e,t){this.state=t,this.movesLeft=e}return e.prototype.updateMovesLeft=function(){this.movesLeft--,this.state.updateMovesLeft(this.movesLeft),0==this.movesLeft&&(this.state.isLevelLose=!0)},e}();o.MoveCounter=i,cc._RF.pop()},{}],ScoreCounterView:[function(e,t,o){"use strict";cc._RF.push(t,"2c9ect3Y9NJ2LjM+5q5CdgP","ScoreCounterView");var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.ScoreCounterView=void 0;var s=cc._decorator,a=s.ccclass,l=s.property,c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scoreLabel=null,t.scoreTextParts=[],t}return n(t,e),t.prototype.init=function(e){this.targetScore=e.toString(),this.scoreTextParts=["0","/",this.targetScore],this.scoreLabel.string=this.scoreTextParts.join("")},t.prototype.updateScore=function(e){this.scoreTextParts[0]=e.toString(),this.scoreLabel.string=this.scoreTextParts.join("")},r([l(cc.Label)],t.prototype,"scoreLabel",void 0),r([a],t)}(cc.Component);o.ScoreCounterView=c,cc._RF.pop()},{}],ScoreCounter:[function(e,t,o){"use strict";cc._RF.push(t,"c2fe7m5IuBBf7CibOqKH5PX","ScoreCounter"),Object.defineProperty(o,"__esModule",{value:!0}),o.ScoreCounter=void 0;var i=function(){function e(e,t){this.score=0,this.tileScore=e,this.state=t}return e.prototype.updateScore=function(e){var t=e.length*this.tileScore;this.score+=t,this.state.updateScore(this.score)},e}();o.ScoreCounter=i,cc._RF.pop()},{}],SimpleTileHandler:[function(e,t,o){"use strict";cc._RF.push(t,"6b143jwTmZAUq1rFl3UeCvP","SimpleTileHandler"),Object.defineProperty(o,"__esModule",{value:!0}),o.SimpleTileHandler=void 0;var i=function(){function e(e,t,o,i,n){this.board=e,this.scoreCounter=t,this.moveCounter=o,this.tileMatcher=i,this.superTileThreshold=n}return e.prototype.handleSimpleTile=function(e){var t=this.tileMatcher.findMatches(e);t.length<2||(t.length>=this.superTileThreshold&&(this.board.createMegaTile(e.position),t=t.filter(function(t){return t!==e})),this.board.setCollapseTiles(t),this.board.removeTiles(t.map(function(e){return e.position})),this.scoreCounter.updateScore(t),this.moveCounter.updateMovesLeft())},e}();o.SimpleTileHandler=i,cc._RF.pop()},{}],SuperTileHandler:[function(e,t,o){"use strict";cc._RF.push(t,"2985byi7/1I0LxDSMLAmL3a","SuperTileHandler"),Object.defineProperty(o,"__esModule",{value:!0}),o.SuperTileHandler=void 0;var i=e("./Tile"),n=function(){function e(e,t,o){this.board=e,this.scoreCounter=t,this.moveCounter=o}return e.prototype.handleSuperTile=function(e){var t=[];switch(e.type){case i.TileType.BOMB:t=this.handleBomb(e);break;case i.TileType.ROW_CLEAR:t=this.handleRowClear(e);break;case i.TileType.COL_CLEAR:t=this.handleColumnClear(e);break;case i.TileType.RADIUS_CLEAR:t=this.handleRadiusClear(e)}this.board.setCollapseTiles(t),this.board.removeTiles(t.map(function(e){return e.position})),this.scoreCounter.updateScore(t),this.moveCounter.updateMovesLeft()},e.prototype.handleColumnClear=function(e){for(var t=[],o=0;o<this.board.config.verticalTileCount;o++)t.push(this.board.grid[o][e.position.column]);return t},e.prototype.handleRowClear=function(e){for(var t=[],o=0;o<this.board.config.horizontalTileCount;o++)t.push(this.board.grid[e.position.row][o]);return t},e.prototype.handleRadiusClear=function(e){for(var t=[],o=[e.position.row,e.position.column],i=o[0],n=o[1],r=this.board.config.superTileRadius,s=i-r;s<=i+r;s++)for(var a=n-r;a<=n+r;a++)s>=0&&s<this.board.config.verticalTileCount&&a>=0&&a<this.board.config.horizontalTileCount&&t.push(this.board.grid[s][a]);return t},e.prototype.handleBomb=function(){return[].concat.apply([],this.board.grid)},e}();o.SuperTileHandler=n,cc._RF.pop()},{"./Tile":"Tile"}],TileFactory:[function(e,t,o){"use strict";cc._RF.push(t,"52ec3CfxRtPSLC3dPrhPPzq","TileFactory"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileFactory=void 0;var i=e("../model/Tile"),n=function(){function e(){}return e.prototype.createRandomTile=function(e){var t;return t=Math.random()<.7?this.getRandomNormalType():this.getRandomSuperType(),new i.Tile(t,e)},e.prototype.createNormalTile=function(e){return new i.Tile(this.getRandomNormalType(),e)},e.prototype.createTileMegaTile=function(e){var t;return t=this.getRandomSuperType(),new i.Tile(t,e)},e.prototype.getRandomNormalType=function(){var e=[i.TileType.RED,i.TileType.BLUE,i.TileType.GREEN,i.TileType.YELLOW,i.TileType.PURPURE];return e[Math.floor(Math.random()*e.length)]},e.prototype.getRandomSuperType=function(){var e=Math.random();if(e<.8){var t=[i.TileType.ROW_CLEAR,i.TileType.COL_CLEAR];return t[Math.floor(Math.random()*t.length)]}return e<.95?i.TileType.RADIUS_CLEAR:i.TileType.BOMB},e}();o.TileFactory=n,cc._RF.pop()},{"../model/Tile":"Tile"}],TileMatcher:[function(e,t,o){"use strict";cc._RF.push(t,"3d29aPg6kBIebVhM2lBT3w/","TileMatcher"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileMatcher=void 0;var i=function(){function e(e,t){this.config=e,this.board=t}return e.prototype.findMatches=function(e){if(!e.isNormalTile())return[];for(var t=[],o=0;o<this.config.verticalTileCount;o++)t.push(new Array(this.config.horizontalTileCount).fill(!1));var i=[];return this.floodFill(e.position,e.type,t,i),i},e.prototype.floodFill=function(e,t,o,i){if(this.board.isPositionValid(e)&&!o[e.row][e.column]){var n=this.board.getTileAt(e);n&&n.type===t&&(o[e.row][e.column]=!0,i.push(n),this.floodFill(this.board.getRightNeighborsPosition(e),t,o,i),this.floodFill(this.board.getLeftNeighborsPosition(e),t,o,i),this.floodFill(this.board.getBottomNeighborsPosition(e),t,o,i),this.floodFill(this.board.getTopNeighborsPosition(e),t,o,i))}},e}();o.TileMatcher=i,cc._RF.pop()},{}],TileSpriteConfig:[function(e,t,o){"use strict";cc._RF.push(t,"5a31cpYm45JW56+1e4swEXv","TileSpriteConfig");var i=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.TileSpriteConfig=void 0;var n=e("../service/TileSpriteEntry"),r=cc._decorator,s=r.ccclass,a=r.property,l=function(){function e(){this.entries=[]}return e.prototype.getSpriteByType=function(e){var t;return(null===(t=this.entries.find(function(t){return t.type===e}))||void 0===t?void 0:t.sprite)||null},i([a({type:[n.TileSpriteEntry]})],e.prototype,"entries",void 0),i([s("TileSpriteConfig")],e)}();o.TileSpriteConfig=l,cc._RF.pop()},{"../service/TileSpriteEntry":"TileSpriteEntry"}],TileSpriteDataBase:[function(e,t,o){"use strict";cc._RF.push(t,"29bbcNm41xKCaxE26i6zkrX","TileSpriteDataBase");var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.TileSpriteDatabase=void 0;var s=e("../config/TileSpriteConfig"),a=e("../model/Tile"),l=cc._decorator,c=l.ccclass,u=l.property,p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.config=null,t}var o;return n(t,e),o=t,t.prototype.onLoad=function(){o.instance=this},t.prototype.getSpriteForType=function(e){return this.config.getSpriteByType(e)},t.prototype.getSizeModeForType=function(e){switch(e){case a.TileType.COL_CLEAR:case a.TileType.ROW_CLEAR:default:return cc.Sprite.SizeMode.TRIMMED}},r([u(s.TileSpriteConfig)],t.prototype,"config",void 0),o=r([c],t)}(cc.Component);o.TileSpriteDatabase=p,cc._RF.pop()},{"../config/TileSpriteConfig":"TileSpriteConfig","../model/Tile":"Tile"}],TileSpriteEntry:[function(e,t,o){"use strict";cc._RF.push(t,"25595Qo3YJAr6YfEyUxUOV3","TileSpriteEntry");var i=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.TileSpriteEntry=void 0;var n=e("../model/Tile"),r=cc._decorator,s=r.ccclass,a=r.property,l=cc.Enum(n.TileType),c=function(){function e(){this.type=n.TileType.RED,this.sprite=null}return i([a({type:l})],e.prototype,"type",void 0),i([a(cc.SpriteFrame)],e.prototype,"sprite",void 0),i([s("TileSpriteEntry")],e)}();o.TileSpriteEntry=c,cc._RF.pop()},{"../model/Tile":"Tile"}],TileViewFactory:[function(e,t,o){"use strict";cc._RF.push(t,"c2437NaTZ5MDq/xNc3oiraY","TileViewFactory"),Object.defineProperty(o,"__esModule",{value:!0}),o.TileViewFactory=void 0;var i=e("../view/TileView"),n=function(){function e(e){this.tilePrefab=null,this.tilePrefab=e,this.tileViewPool=[]}return e.prototype.createTileView=function(e){if(this.tileViewPool.length>0)return(t=this.tileViewPool.pop()).node.active=!0,t.node.scale=1,t;var t,o=cc.instantiate(this.tilePrefab);return o.parent=e,o.getComponent(i.TileView)},e.prototype.dispose=function(e){e.node.active=!1,this.tileViewPool.push(e)},e}();o.TileViewFactory=n,cc._RF.pop()},{"../view/TileView":"TileView"}],TileView:[function(e,t,o){"use strict";cc._RF.push(t,"223c20uFL1MCZKoWB8jS0Lf","TileView");var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),r=this&&this.__decorate||function(e,t,o,i){var n,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(s=(r<3?n(s):r>3?n(t,o,s):n(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};Object.defineProperty(o,"__esModule",{value:!0}),o.TileView=void 0;var s=e("../service/TileSpriteDataBase"),a=cc._decorator,l=a.ccclass,c=a.property,u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sprite=null,t.label=null,t.animationTileRemoveDuration=.2,t.animationTileRemoveScaleDownValue=0,t.animationTileRemoveOpacityDownValue=0,t.animationTileAppearDuration=.3,t.animationTileAppearScaleUpValue=1,t._onTileClick=null,t.position=null,t}return n(t,e),t.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.onClick,this)},t.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this)},t.prototype.init=function(e,t,o,i){this.position=t,this.node.setPosition(cc.v3(t.x,t.y)),this.node.width=o.x,this.node.height=o.y,this._onTileClick=i,this.updateView(e)},t.prototype.updateView=function(e){this.label.string="",e?(this.node.active=!0,this.position=e.position,this.sprite.spriteFrame=s.TileSpriteDatabase.instance.getSpriteForType(e.type),this.sprite.sizeMode=s.TileSpriteDatabase.instance.getSizeModeForType(e.type)):this.node.active=!1},t.prototype.animateRemove=function(){var e=this;return new Promise(function(t){cc.tween(e.node).to(e.animationTileRemoveDuration,{scale:e.animationTileRemoveScaleDownValue,opacity:e.animationTileRemoveOpacityDownValue}).call(function(){e.node.active=!1,t()}).start()})},t.prototype.animateAppear=function(){var e=this;return this.node.setScale(0),this.node.active=!0,new Promise(function(t){cc.tween(e.node).to(e.animationTileAppearDuration,{scale:e.animationTileAppearScaleUpValue},{easing:"backOut"}).call(t).start()})},t.prototype.onClick=function(){this._onTileClick&&this._onTileClick(this.position)},r([c(cc.Sprite)],t.prototype,"sprite",void 0),r([c(cc.Label)],t.prototype,"label",void 0),r([c(cc.Integer)],t.prototype,"animationTileRemoveDuration",void 0),r([c(cc.Integer)],t.prototype,"animationTileRemoveScaleDownValue",void 0),r([c(cc.Integer)],t.prototype,"animationTileRemoveOpacityDownValue",void 0),r([c(cc.Integer)],t.prototype,"animationTileAppearDuration",void 0),r([c(cc.Integer)],t.prototype,"animationTileAppearScaleUpValue",void 0),r([l],t)}(cc.Component);o.TileView=u,cc._RF.pop()},{"../service/TileSpriteDataBase":"TileSpriteDataBase"}],Tile:[function(e,t,o){"use strict";var i;cc._RF.push(t,"149bbuXNitDQKcq1J0x1/67","Tile"),Object.defineProperty(o,"__esModule",{value:!0}),o.Tile=o.Position=o.TileType=void 0,function(e){e[e.BLUE=0]="BLUE",e[e.PURPURE=1]="PURPURE",e[e.YELLOW=2]="YELLOW",e[e.GREEN=3]="GREEN",e[e.RED=4]="RED",e[e.BOMB=5]="BOMB",e[e.COL_CLEAR=6]="COL_CLEAR",e[e.RADIUS_CLEAR=7]="RADIUS_CLEAR",e[e.ROW_CLEAR=8]="ROW_CLEAR"}(i=o.TileType||(o.TileType={}));o.Position=function(e,t,o,i){this.x=e,this.y=t,this.row=o,this.column=i};var n=function(){function e(e,t){this.type=e,this.position=t}return e.prototype.isSuperTile=function(){return[i.ROW_CLEAR,i.COL_CLEAR,i.RADIUS_CLEAR,i.BOMB].includes(this.type)},e.prototype.isNormalTile=function(){return!this.isSuperTile()},e}();o.Tile=n,cc._RF.pop()},{}]},{},["AssetsPath","EventEmitter","GameEvents","GameConfig","GameConfigPrefab","TileSpriteConfig","GameContoller","LevelController","LevelViewFactory","TileFactory","TileViewFactory","EntryPoint","Board","BoosterHandler","BoosterType","GameState","MoveCounter","ScoreCounter","SimpleTileHandler","SuperTileHandler","Tile","TileMatcher","AssetLoader","TileSpriteDataBase","TileSpriteEntry","AnimatorBoardView","BoardView","BoosterView","GameView","LevelView","MoveCounterView","ScoreCounterView","TileView"]);